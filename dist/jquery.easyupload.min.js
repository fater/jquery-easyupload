!function(e){var s={url:document.URL,data:{},file_name:"file",on_progress:function(e){},on_upload_before:function(e){},on_upload_file:function(e){},on_upload_finish:function(){},on_upload_error:function(e){}},o={files:{},all_files_size:0,uploaded_size:0,size:0,send_pos:0,sender_launched:!1},n=function(n,i){var r=this;r.element=e(n),r.options=e.extend({},s,i),r.process=e.extend({},o),r.element.on("change",function(e){r.queue(e.target.files)})};n.prototype.queue=function(s){var o=this;e.each(s,function(e,s){o.process.size++,o.process.files[o.process.size]=s,o.process.all_files_size+=s.size}),0==o.process.sender_launched&&(o.options.on_upload_before({files:o.process.size,files_size:o.process.all_files_size}),o.process.sender_launched=!0,o.send())},n.prototype.send=function(){var s=this;if(s.process.send_pos>=s.process.size)return s.process=e.extend({},o),s.options.on_upload_finish(),null;s.process.send_pos++;var n=new FormData;n.append(s.options.file_name,s.process.files[s.process.send_pos]),e.each(s.options.data,function(e,s){n.append(e,s)}),e.ajax({url:s.options.url,type:"POST",data:n,cache:!1,dataType:"json",processData:!1,contentType:!1,complete:function(e){s.process.uploaded_size+=s.process.files[s.process.send_pos].size,s.send()},success:function(e){s.options.on_upload_file(e)},error:function(o){var n=s.process.files[s.process.send_pos].name;s.options.on_upload_error.call(this,e.extend(o,{file_name:n}))},xhr:function(){var o=e.ajaxSettings.xhr();return o.upload.onprogress=function(e){var o={};o.progress_file=e.loaded/e.total*100,o.progress_total=(s.process.uploaded_size+e.loaded)/s.process.all_files_size*100,o.total_files=s.process.size,o.current_file=s.process.send_pos,s.options.on_progress(o)},o.upload.onload=function(){},o}})},e.fn.easyupload=function(e){this.each(function(){return new n(this,e)})}}(jQuery);